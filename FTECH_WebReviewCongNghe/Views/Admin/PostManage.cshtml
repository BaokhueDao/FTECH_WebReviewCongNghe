@{
    ViewBag.Title = "PostManage";
    Layout = null;
    List<FTECH_WebReviewCongNghe.Models.BAIVIET> dsBV = ViewBag.dsBaiViet;
    List<FTECH_WebReviewCongNghe.Models.TAIKHOAN> dsTK = ViewBag.dsTaiKhoan;
    List<FTECH_WebReviewCongNghe.Models.TRANGTHAIBAIDANG> dsTT = ViewBag.dsTrangThai;
    List<FTECH_WebReviewCongNghe.Models.LOAIBAIDANG> dsLBD = ViewBag.dsLoaiBaiDang;
    List<FTECH_WebReviewCongNghe.Models.DANHMUC> dsDM = ViewBag.dsDanhMuc;
    String urlDelete = "/Admin/deletePost";
}
@{ FTECH_WebReviewCongNghe.Models.TAIKHOAN tk = (FTECH_WebReviewCongNghe.Models.TAIKHOAN)Session["account"]; }
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Quản lý bài đăng</title>

    <!-- Custom fonts for this template-->
    <link href="~/MySource/admin/vendor/fontawesome-free-6.5.2-web/fontawesome-free-6.5.2-web/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="~/MySource/admin/css/content-admin.min.css" rel="stylesheet">
    <script>
        function confirmDelete() {
            return confirm("Bạn có chắc chắn muốn xóa không?");
        }
    </script>
</head>

<body>

    <div id="wrapper">
        <ul class="sidebar navbar-nav">
            <img src="~/MySource/img/logo.jpg"> <!-- Hình ảnh mặc định -->
            <li class="nav-item" style="text-align: center; margin-bottom:15px;">
                <a class="nav-link avt" href="~/MySource/admin/#" id="userDropdown" role="button" aria-haspopup="true" aria-expanded="false">
                    <img src="~/MySource/img/avt.jpg" class="avatar" alt="Avatar" style="width: 50px; height: 50px; float: left; margin-right: 10px; border-radius: 50%;">
                    <div style="float: left;">
                        <span class="name" style="display: block; font-weight: bold; margin-bottom: 5px;">@tk.HOVATEN</span>
                        <span class="job" style="font-size: smaller;">@tk.CHUCVU.TENCHUCVU</span>
                    </div>
                </a>
            </li>
            <li class="nav-item" style="background-color: #CEE2F5;">

                <a class="nav-link" href="~/Admin/PostManage">
                    <i class="fa-solid fa-file" style="color: #121212;"></i>
                    <span style="color: #121212;font-weight: 500;">Quản lý bài đăng</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="~/Admin/addPost">
                    <i class="fa-solid fa-plus" style="color: #ffffff;"></i>
                    <span>Thêm bài đăng</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="~/Admin/reviewPost">
                    <i class="fa-solid fa-eye" style="color: #ffffff;"></i>
                    <span>Duyệt bài đăng</span>
                </a>
            </li>
        </ul>

        <div id="content-wrapper" style="margin: 10px;color:#0A5DA9;">

            <div class="container-fluid">
                <div class="card mb-3">
                    <div class="card-header">
                        <i class="fa-solid fa-bars"></i>
                        <a href="~/Admin/Index" style="text-decoration: none; color: #0A5DA9">
                            Quản lý
                            <i class="fas fa-chevron-right"></i>
                        </a>
                        <a>

                            Quản lý bài đăng
                        </a>
                    </div>
                    <section class="hero" style="margin-top: 0;">
                        <div class="nav-item @(ViewBag.Title == "addPost" ? "active" : null)" style="display:flex;justify-content: right;margin: 10px;">
                            <a class="nav-link" href="~/Admin/addPost">
                                <button style="color:#ffffff;font-weight: 500;background-color: #003366;"><i class="fa-solid fa-plus" style="color: #ffffff;margin-right: 5px;"></i>Thêm bài đăng</button>
                            </a>
                        </div>
                        <form action="~/Admin/PostManage" method="post" enctype="multipart/form-data">
                            <div class="container" style="display: flex;justify-content: space-around;">

                                <div class="col" style="flex:1">
                                    <label style="margin-bottom: 10px;">Loại bài đăng</label>
                                    <div class="custom-selects" style="width: 60%;background-color:#ffff">


                                        <select class="ss-option" name="MALOAI" required style="width:200px;padding:10px;border:2px solid #0A5DA9;border-radius:5px; color: #0A5DA9">
                                            <option>Tất cả</option>
                                            @foreach (var loaibd in dsLBD)
                                            {
                                                <option value="@loaibd.MALOAI" style="width: 200px; padding: 10px; border: 2px solid #0A5DA9; border-radius: 5px; color: #0A5DA9">@loaibd.LOAIBAIDANG1</option>
                                            }

                                        </select>
                                    </div>
                                </div>
                                <div class="col" style="flex:1">
                                    <label style="margin-bottom: 10px;">Trạng thái</label>
                                    <div class="custom-selects" style="width: 60%;background-color:#ffff">
                                        <select class="ss-option" name="MATRANGTHAI" required style="width:200px;padding:10px;border:2px solid #0A5DA9;border-radius:5px; color: #0A5DA9">
                                            <option>Tất cả</option>
                                            @foreach (var tthai in dsTT)
                                            {
                                                <option value="@tthai.MATRANGTHAI" style="width: 200px; padding: 10px; border: 2px solid #0A5DA9; border-radius: 5px; color: #0A5DA9">@tthai.TRANGTHAIBAIDANG1</option>

                                            }

                                        </select>


                                    </div>
                                </div>
                                <div class="col" style="flex:1">
                                    <label style="margin-bottom: 10px;">Danh mục chính</label>
                                    <div class="custom-selects" style="width: 60%; background-color:#ffff">

                                        <select class="ss-option" name="MADANHMUC" required style="width:200px;padding:10px;border:2px solid #0A5DA9;border-radius:5px; color: #0A5DA9">
                                            <option>Tất cả</option>
                                            @foreach (var dmc in dsDM)
                                            {

                                                <option value="@dmc.MADANHMUC" style="width: 200px; padding: 10px; border: 2px solid #0A5DA9; border-radius: 5px; color: #0A5DA9">
                                                    @dmc.TENDANHMUC
                                                </option>
                                            }

                                        </select>
                                    </div>
                                </div>
                                <div class="col" style="margin-top: 25px;margin-left: -40px;height: 50px;width: 50px;flex:1">
                                    <button type="submit" style="height: 40px;width: 40px;background-color: #F8F8FA;border-radius: 5px;margin-top:10px"><i class="fa-solid fa-filter" style="color: #0A5DA9;"></i></button>

                                </div>
                        </form>
                </div>
                </section>



                <div class="card-body">
                    <div id="tableRes" class="table-responsive" style="color: #0A5DA9;">
                        <table class="table table-bordered" width="100%" cellspacing="0" style="color: #0A5DA9;">

                            <thead>
                                <tr>
                                    <th style="width:70px; text-align:center;">ID</th>
                                    <th style="width:230px;">Tiêu đề</th>
                                    <th style="width:200px; text-align:center;">Loại bài đăng</th>
                                    <th style="width:250px; text-align:center;">Danh mục chính</th>
                                    <th style="width:100px; text-align:center;">Tác giả</th>
                                    <th style="text-align: center; width: 100px;">Trạng thái</th>
                                    <th style="text-align: center; width: 100px;">Cập nhật</th>
                                    <th colspan="2" style="width:130px; text-align:center;"></th>
                                </tr>
                            </thead>

                            <tbody>
                                @foreach (var i in dsBV)
                                {
                                    var trangthai = dsTT.FirstOrDefault(tt => tt.MATRANGTHAI == i.MATRANGTHAI)?.TRANGTHAIBAIDANG1 ?? "Đang cập nhật";
                                    var danhmuc = dsDM.FirstOrDefault(tt => tt.MADANHMUC == i.MADANHMUC)?.TENDANHMUC ?? "Đang cập nhật";
                                    var loai = dsLBD.FirstOrDefault(tt => tt.MALOAI == i.MALOAI)?.LOAIBAIDANG1 ?? "Đang cập nhật";
                                    <tr>
                                        <td style="text-align:center;">@i.MABAIVIET</td>
                                        <td>@i.TENBAIVIET</td>
                                        <td style="text-align:center;">@loai</td>
                                        <td style="text-align:center;">@danhmuc</td>
                                        <td style="text-align:center;">@i.TACGIA</td>
                                        <td style="text-align:center;" id="col_status_@i.MATRANGTHAI">@trangthai</td>
                                        <td style="text-align:center;">@i.NGAYDANG</td>
                                        <td style="text-align:center;"><a href="~/Admin/reviewPost?MABAIVIET=@i.MABAIVIET"><button style="width:60px;background-color: #F8F8FA;color: #0A5DA9;border-radius: 5px;" class="btnUpdate">Xem</button></a></td>
                                        <td style="text-align:center;">
                                            <form action="~/Admin/deletePost" method="post" enctype="multipart/form-data" onsubmit=" return confirmDelete();">
                                                <input type="hidden" name="MABAIVIET" value="@i.MABAIVIET" />

                                                <button onclick="" type="submit" style="width:60px;background-color: #F8F8FA;color: #0A5DA9;border-radius: 5px" class="btnUpdate">Xóa</button>
                                            </form>

                                        </td>
                                    </tr>

                                }
                            </tbody>
                            </form>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    </div>
    <script src="123/js/jquery-3.3.1.min.js"></script>
    <script src="123/js/bootstrap.min.js"></script>
    <script src="123/js/jquery-ui.min.js"></script>
    <script src="123/js/jquery.nice-select.min.js"></script>
    <script src="123/js/jquery.slicknav.js"></script>
    <script src="123/js/mixitup.min.js"></script>
    <script src="123/js/owl.carousel.min.js"></script>
    <script src="123/js/main.js"></script>
    <script src="123/js/sweetalert2.min.js"></script>
</body>
</html>
